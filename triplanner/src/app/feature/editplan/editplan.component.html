<app-profile></app-profile>
<div class="content2">
    <div id='block1'>
    <br>
        MY PLAN
    </div>
    <!--test-->
<!--test-->
<br>
    <div *ngIf="isEdit == false&&isDelete ==false && isCoplanning == false && showPlan==false;else ">
        <div *ngFor="let item of plan; let i = index" (click)="moveToPlandetail(item.plan_id);">
            <div style="margin-left:65px; color:#fadd02; font:600 20px/22px 'Open Sans',sans-serif;"><img src="/assets/images/edit.png" style="width:50px;height:50px">{{item.plan_name}}</div>
            <div class="hr"></div>
        </div>
        <div  *ngFor="let item of coplan; let i = index" (click)="moveToPlandetail(item.plan_id);">
            <div style="margin-left:65px; color:#ff5e00; font:600 20px/22px 'Open Sans',sans-serif;"><img src="/assets/images/edit.png" style="width:50px; height:50px">{{item.plan_name}} (CO-PLAN)</div>
            <div class="hr"></div>
        </div>
    </div>

    <ng-template #edit [ngIf]="isEdit == true &&isDelete ==false">

        <!--  here -->
        <div id='block1' style="font-size:22px;margin-left:42% ">{{tripName}}</div>
        <br>
        <div id='block1' style="float:left;font-size:18px">DEPART DATE<br>{{departDate}} </div>
        <div id='block1' style="float:right;font-size:18px;margin-right:65px;">RETURN DATE<br>{{returnDate}}</div>
        <br>
        <div id='block1' style="text-align:center;font-size:20px">DAY{{resultDate}} </div>
        <br>
        
        <div *ngIf="isHide == false ;else hide ">

            <div *ngFor="let d of days;let j =index;">

                <mat-toolbar style="background:rgb(66, 161, 202); color:white">

                    <span>Day{{j+1}}({{days[j].thatDate}}) </span>
                    <span clasee="example-spacer"> </span>
                    <button mat-button [matMenuTriggerFor]="appMenu">
                        <mat-icon>add</mat-icon>
                    </button>

                </mat-toolbar>
                <br>

                <mat-menu #appMenu="matMenu">
                    <div *ngFor="let activity of activities;let index =index;"> 
                    <button mat-menu-item (click)="act_temp = activities[index].type ;isActCreate[j]=true;">{{activities[index].type}}</button>
                    <!--  ex activites (need database) -->
    
                    <!--  ex activites (need database) -->
                    </div>
                </mat-menu>


                <div class="table-users">
                    <table cellspacing="0" >
                           <tr  *ngFor="let act of d.acts;let i =index;">

                                <td >{{i+1}}</td>
                                <td >{{days[j].times[i]}}</td>
                                <td>{{days[j].details[i]}}</td>
                                <td>{{days[j].acts[i]}}</td>
                                <td>
                                    <button mat-button (click)="removeActs(i,j)">
                                            <mat-icon>remove</mat-icon>
                                    </button>
                                </td>
                            </tr>
                        </table>
                   
                </div>

                <!-- ?????????? -->
                <div *ngIf="isActCreate[j] == true ;else ">
                    
                <div class="table-users">
                    <div class="header">PLAN SCHEDULE</div>
                    
                    <table cellspacing="0">
                       <tr>
                          <th width="230">Time</th>
                          <th width="400" >Detail</th>
                          <th width="400">Activities</th>
                       </tr>
                 
                       <tr>
                            <td>
                                    <input type="time" [(ngModel)]="time" required />
                                    <br>
                                </td>
            
                                <td>
                                    <input type="text" placeholder="detail" [(ngModel)]="detail" required />
                                    <br>
                                </td>
                                <td>
                                    {{act_temp}}
                                </td>
                                <!-- button for addActivities to database (from addActs()) -->
                       </tr>
                    </table>
                 </div>
                    <div style="float:right;width: 10%">
                        <br>
                        <button class="btn btn-primary btn-block btn-large" (click)="addActs(act_temp,time,detail,j);detail='';time='';">submit</button>
                    
                    </div>
                    <br>
                    <br>
                    <div style="color:red;float:left">{{status2}}</div>
                    <br>

                </div>

            </div>



            <!-- <button routerLink="/generateplan">generateplan !!</button> <button type="button" class="btn btn-primary" (click)="isHide= true"> Generate Plan</button>  -->
            <br>
            <br>
            <br>
            <br>
                <button type="button" class="btn sixth" (click)="isHide= true" style="margin-left:42% " >Generate Plan</button>
                
            
            

        </div>
    </ng-template>

    <ng-template #hide [ngIf]="showPlan==true">

        <button *ngFor="let d of days;let j =index;" class="btn one" (click)="dayShowing(j,resultDate)">day {{j+1}}</button>
        <div *ngFor="let d of days;let j =index">
            <div *ngIf="dayShow[j] == true ;else ">
                <div style="margin-left:20%; color:#fcfcfc; font:600 20px/22px 'Open Sans',sans-serif; text-align: center;">
                    DAY:{{days[j].thatDate}}
                </div>
                <div class="table-users">
                        <div class="header">PLAN SCHEDULE</div> 
                        <table cellspacing="0" >
                           <tr>
                                
                                <th style="text-align: center;">Time</th>
                                <th style="text-align: center;">Detail</th>
                                <th style="text-align: center;">Activitie</th>
                                <th style="text-align: center;">    </th>
                           </tr>
                           <tr  *ngFor="let act of d.acts;let i =index;">

                                
                                <td >{{days[j].times[i]}}</td>
                                <td>{{days[j].details[i]}}</td>
                                <td>{{days[j].acts[i]}}</td>
                                <td style="align-items: center;"><img src={{getActivity(act)}}  style="width:48px;height:48px;background:white"> </td>
                            </tr>
                        </table>
                        <thead>
                                <th></th>
            
                            </thead>
                </div>
                
            </div>
        </div>
        
        <ng-template [ngIf]="isEdit==true">

                <br>
                <br>
                <br>
                <br>
                <button class="btn sixth" (click)="confirm();" style="margin-left:50% ">confirm</button>
                

        </ng-template>

        <ng-template [ngIf]="isEdit==false">
            <div class="block">
                <button class="btn one" style="font-size: 14px; float: left; margin-top:10px;  margin-left:50px;" (click)="moveToPlandetail1(plan_id); isEdit = true ; isDelete = false ;isCoplanning = false; showPlan =false;">EDIT</button>
                <button class="btn one" style="font-size: 14px; float: left; margin-top:10px;  margin-left:5px;" (click)="moveToPlandetail(plan_id); isEdit = false; isDelete = true  ;isCoplanning = false; delete_temp = plan_id  ">DELETE</button>
                <button class="btn one" style="font-size:14px; float: left; margin-top:10px;  margin-left:5px;" (click)="moveToPlandetail(plan_id); isEdit = false; isDelete = false ;isCoplanning = true;  isDelete =false ">Co-Planning </button>
                </div>       
        </ng-template>

    </ng-template>


    <!-- deletepage -->

    <ng-template #deletepage [ngIf]="isEdit == false &&isDelete ==true">

            
                <br>
                <br>
                <br>
                <br>
                <br>
                <br>
                <label style="font-size:14px; margin-left:40% ">
                    <span class="btn one" style="font-size:14px; ">CONFIRM DELETE</span>
                    <input type="checkbox" />
                    <div class="confirm-modal">
                      <form action="#do-something" method="get">
                        <div id="font" style="color:rgb(46, 46, 46)">Are you absolutely sure you want to delete</div>
                        <br>
                        <button class="btn one" (click)="deletePlan(delete_temp)"  style="margin-left:38%  " >Yes</button>
                        <!--<button class="btn one" href="#0">No</button>-->
                      </form>
                    </div>
                </label>
        <br>
        <!--<button (click)="deletePlan(delete_temp)">confirm delete</button>-->

    </ng-template>

        <!--Co Planning-->
    <ng-template #coplanning [ngIf]="isCoplanning == true">
        <br>
        <br>
        <br>
        <br>
        <div id='block2' style="color:white;">CO-PLANNER USERNAME</div>
        <div class="group" style="align-items:center;">
            <input type="text" class="input" placeholder="Put your co-planner username" [(ngModel)]="co_username" required />
            <div style= "color:darkred"> {{co_text}}</div>
        </div>
        <button class="btn sixth" (click)="Co_Confirm()"style="margin-left:45% ">confirm</button>
    </ng-template>
    <ng-template #back_butoon [ngIf]='isEdit==true||isDelete==true||isCoplanning==true||showPlan==true'>
            <br>
            <br>
            <br>
            <br>
      <button class="btn sixth" (click)="this.ngOnInit()" >BACK</button>
    </ng-template>

    
</div>