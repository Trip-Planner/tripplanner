<div class="content">
    <div id='block1'>
    <br>
        MY PLAN
    </div>

<div id='block1'>
    <div *ngIf="isEdit == false&&isDelete ==false && isCoplanning == false && showPlan==false;else ">
        <li *ngFor="let item of plan; let i = index" (click)="moveToPlandetail(item.plan_id);showPlan=true">
             {{item.plan_name}}
        </li>
        <li *ngFor="let item of coplan; let i = index" (click)="moveToPlandetail(item.plan_id);showPlan=true">
              {{item.plan_name}} (CO-PLAN)
            </li>
    </div>

    <button (click)="this.ngOnInit()" > BACK</button>
    <ng-template #edit [ngIf]="isEdit == true &&isDelete ==false">

        <!--  here -->
        <div style="font-size:40px;color:white;text-align:center">{{tripName}}</div>
        <br>
        <div style="float:left;font-size:20px">{{departDate}} </div>
        <div style="float:right;font-size:20px">{{returnDate}}</div>
        <br>
        <div style="text-align:center;font-size:20px">{{resultDate}} day</div>
        <br>
        <div *ngIf="isHide == false ;else hide ">

            <div *ngFor="let d of days;let j =index;">

                <mat-toolbar style="background:rgb(19, 155, 218);color:white">

                    <span>Day{{j+1}}({{days[j].thatDate}}) </span>
                    <span clasee="example-spacer"> </span>
                    <button mat-button [matMenuTriggerFor]="appMenu">
                        <mat-icon>add</mat-icon>
                    </button>

                </mat-toolbar>
                <br>

                <mat-menu #appMenu="matMenu">
                    <button mat-menu-item (click)="act_temp = 'Chiangmai';isActCreate[j]=true">Chiang Mai</button>
                    <!--  ex activites (need database) -->
                    <button mat-menu-item (click)="act_temp = 'Bangkok';isActCreate[j]=true">Bangkok</button>
                    <!--  ex activites (need database) -->
                </mat-menu>


                <table id="table">
                    <thead id="table-odd">
                    </thead>
                    <tr id="table-even" *ngFor="let act of d.acts;let i =index;">

                        <td style="color:white;padding-left:30px;padding-right: 30px;">{{i+1}}</td>

                        <td style="color:white;padding-right: 30px;">{{days[j].times[i]}}</td>

                        <td style="color:white;padding-right: 30px;">{{days[j].details[i]}}</td>

                        <td style="color:white;padding-right: 30px;">{{days[j].acts[i]}}</td>

                        <td>
                            <button mat-button (click)="removeActs(i,j)">
                                <mat-icon>remove</mat-icon>
                            </button>
                        </td>
                    </tr>
                </table>

                <!-- ?????????? -->
                <div *ngIf="isActCreate[j] == true ;else ">
                    <!-- condition for showing set_activities_detail -->
                    <div style="float:left;width: 90%">
                        <table id="table" style="background:white;width:100%">
                            <thead id="table-even">
                                <th>Time</th>
                                <th>Detail</th>
                                <th>Activity</th>
                            </thead>
                            <td>
                                <input type="time" [(ngModel)]="time" required />
                                <br>
                            </td>

                            <td>
                                <input type="text" placeholder="detail" [(ngModel)]="detail" required />
                                <br>
                            </td>
                            <td>
                                {{act_temp}}
                            </td>
                            <!-- button for addActivities to database (from addActs()) -->

                        </table>
                    </div>
                    <div style="float:right;width: 10%">
                        <br>
                        <button class="btn btn-primary btn-block btn-large" (click)="addActs(act_temp,time,detail,j);detail='';time='';">submit</button>
                    </div>
                    <br>
                    <br>
                    <div style="color:red;float:left">{{status2}}</div>
                    <br>

                </div>

            </div>



            <!-- <button routerLink="/generateplan">generateplan !!</button>   -->
            <button type="button" class="btn btn-primary" (click)="isHide= true"> Generate Plan</button>

        </div>
    </ng-template>


    <ng-template #hide [ngIf]="showPlan==true">


        <button *ngFor="let d of days;let j =index;" class="btn btn-primary" (click)="dayShowing(j,resultDate)">day {{j+1}}</button>
        <div *ngFor="let d of days;let j =index">
            <div *ngIf="dayShow[j] == true ;else ">
                <a>
                    day:{{days[j].thatDate}}
                </a>

                <table>

                    <thead>
                        <th *ngFor="let act of days[j].acts;let l =index;">{{act}}</th>
                    </thead>
                    <td *ngFor="let act of days[j].acts;let l =index;">
                        <img src="../../assets/images/background.jpg" style="width:48px;height:48px;"> </td>
                    <!-- activity image (j =index) -->


                    <table id="table">
                        <thead id="table-odd">
                            <th>Index</th>
                            <th>Time</th>
                            <th>Detail</th>
                            <th>Activitie</th>

                        </thead>
                        <br>
                        <tr id="table-even" style="background:white;width:100%" *ngFor="let act of d.acts;let i =index;">

                            <td>{{i+1}}</td>

                            <td>{{days[j].times[i]}}</td>

                            <td>{{days[j].details[i]}}</td>

                            <td>{{days[j].acts[i]}}</td>
                        </tr>
                    </table>
                    <thead>
                        <th></th>

                    </thead>

                </table>

            </div>
        </div>
        <ng-template [ngIf]="isEdit==true">

            <button class="btn btn-primary" (click)="confirm();">confirm</button>

        </ng-template>

        <ng-template [ngIf]="isEdit==false">

            <li>

                <button (click)="moveToPlandetail(plan_id); isEdit = true ; isDelete = false ;isCoplanning = false; showPlan =flase">EDIT</button>
                <button (click)="moveToPlandetail(plan_id); isEdit = false; isDelete = true  ;isCoplanning = false; delete_temp = plan_id  ">DELETE</button>
                <button (click)="moveToPlandetail(plan_id); isEdit = false; isDelete = false ;isCoplanning = true;  isDelete =false ">Co-Planning </button>
            </li>
        </ng-template>

    </ng-template>


    <!-- deletepage -->

    <ng-template #deletepage [ngIf]="isEdit == false &&isDelete ==true">
        <br> ARE YOU SURE ??
        <br>
        <button (click)="deletePlan(delete_temp)">confirm delete</button>

    </ng-template>

    <ng-template #coplanning [ngIf]="isCoplanning == true">

        <input type="text" placeholder="put your co-planner username" [(ngModel)]="co_username" required />
        <button (click)="Co_Confirm()">Confirm</button>
    </ng-template>
</div>
</div>