<app-profile></app-profile>
<div class="content1">
    <br>
          <div id='block1'>
              MAKE YOUR PLAN
              <br>
          </div>
           <div *ngIf="isSubmit == false ;else set_activities ">
               <br>
               <div id='fnt'style="text-align:center;" >TRIP NAME</div>
                    <br>
                    <div class="block2" style=" margin-left:40%">
                    <input  type="text"  placeholder="Enter your trip name" name="tripName" [(ngModel)]="tripName" required />
                    <br>
                    <br>
                    </div>
                     <div id='fnt1'>
                     <p style="float:left; margin-left:10%;font-weight: bold; ">START DATE
                         <input type="date" style="color:rgb(255, 255, 255); border: 1px solid #030303; font-size:16px; background-color: transparent;" name="departDate" id="fontb" [(ngModel)]="departDate" placeholder="yyyy-MM-dd" min={{now}} max="2019-12-31"
                         required /> </p> 
                    <p style="float:right; margin-right:10%;font-weight: bold; ">END DATE 
                        <input type="date" style="color:rgb(255, 255, 255);border: 1px solid #030303; font-size:16px; background-color: transparent;" name="returnDate" id="fontb" [(ngModel)]="returnDate" placeholder="yyyy-MM-dd" min={{departDate}} max="2019-12-31"
                         required /></p>  
                     </div>
                     <br>
                     <br>
                     <br>
                      <br>
                     <div style="color:rgb(247, 107, 107); font-size:16px; text-align:center; font-weight: bold; ">{{status1}}</div>
                     <br>
                     <br>
                     <div  style="margin-left :43%;" >
                            <button type="submit" class="button" (click)="calculateDate()">Start Planning</button>
                        </div>
                     
                    <br>
                    <br>
        </div>  
     <ng-template #set_activities>

        <div id='block1'  style="text-align:center; text-transform: uppercase;">{{tripName}}</div>
        <br>
        <div id='block1' style="float:left;font-size:18px; margin-left:30px;">START DATE <br>{{departDate}} </div>
        <div id='block1' style="float:right;font-size:18px; margin-right:30px;">END DATE<br>{{returnDate}}</div>
        <br>
        <br>
        <br>
        <div id='block1' style="text-align:center;font-size:20px">{{resultDate}} day</div>
        <br>
        <div *ngIf="isHide == false ;else hide ">

            <div *ngFor="let d of days;let j =index;">

                <mat-toolbar style="background:rgb(66, 161, 202); color:white">

                    <span>Day{{j+1}}({{days[j].thatDate}}) </span>
                    <span clasee="example-spacer"> </span>
                    <button mat-button [matMenuTriggerFor]="appMenu">
                        <mat-icon>add</mat-icon>
                    </button>

                </mat-toolbar>
                <br>
                <mat-menu #appMenu="matMenu">
                    <div *ngFor="let activity of activities;let index =index;">
                        <button mat-menu-item (click)="act_temp = activities[index].type ;isActCreate[j]=true;">{{activities[index].type}}</button>
            
                    </div>
                </mat-menu>

                <!--ตารางเพิ่มactivity-->
                <div class="table-users">
                        <table cellspacing="0" >
                               <tr  *ngFor="let act of d.acts;let i =index;">
    
                                    <td >{{i+1}}</td>
                                    <td >{{days[j].times[i]}}</td>
                                    <td>{{days[j].details[i]}}</td>
                                    <td>{{days[j].acts[i]}}</td>
                                    <td>
                                        <button mat-button (click)="removeActs(i,j)">
                                                <mat-icon>remove</mat-icon>
                                        </button>
                                    </td>
                                </tr>
                            </table>
                    </div>

                <!-- กรอกข้อมูล -->
               <div *ngIf="isActCreate[j] == true ;else ">
                    <!-- condition for showing set_activities_detail -->
                    <div style="float:left;width: 90%">
                        <table id="table" style="background:white;width:100%">
                            <thead id="table-even">
                                <th>Time</th>
                                <th>Detail</th>
                                <th>Activity</th>
                            </thead>
                            <td>
                                <input type="time" [(ngModel)]="time" required />
                                <br>
                            </td>

                            <td>
                                <input type="text" placeholder="detail" [(ngModel)]="detail" required />
                                <br>
                            </td>
                            <td>
                                {{act_temp}}
                            </td>
                            <!-- button for addActivities to database (from addActs()) -->

                        </table>
                    </div>
                    <br>
                    <div style="float:right;width: 10%; align-items:center">
                        <br>
                        <button class="btn btn-primary btn-block btn-large" (click)="addActs(act_temp,time,detail,j);detail='';time='';">submit</button>
                    </div>
                    <br>
                    <br>
                    <div style="color:red;float:left">{{status2}}</div>
                    <br>

                </div>

            </div>
            <br>
          <div  style="margin-left :42%;" >
                <br>

                <button type="button" class="button" (click)="isHide= true">Generate Plan</button>
            </div>
        </div>

    </ng-template>

    <!--  generate -->
    <ng-template #hide>


            <button *ngFor="let d of days;let j =index;" class="btn one" (click)="dayShowing(j,resultDate)">day {{j+1}}</button>
            <div *ngFor="let d of days;let j =index">
                <div *ngIf="dayShow[j] == true ;else ">
                    <a style="margin-left:30%; color:#fcfcfc; font:600 20px/22px 'Open Sans',sans-serif; text-align: center;">
                        DAY:{{days[j].thatDate}}
                    </a>
                    <div class="table-users">
                            <div class="header">PLAN SCHEDULE</div> 
                            <table cellspacing="0" >
                               <tr>
                                    
                                    <th style="text-align: center;">Time</th>
                                    <th style="text-align: center;">Detail</th>
                                    <th style="text-align: center;">Activitie</th>
                                    <th style="text-align: center;">    </th>
                               </tr>
                               <tr  *ngFor="let act of d.acts;let i =index;">
    
                                    
                                    <td >{{days[j].times[i]}}</td>
                                    <td>{{days[j].details[i]}}</td>
                                    <td>{{days[j].acts[i]}}</td>
                                    <td style="align-items: center;"><img src={{getActivity(act)}}  style="width:48px;height:48px;background:white"> </td>
                                </tr>
                            </table>
                            <thead>
                                    <th></th>
                
                                </thead>
                    </div>
                    
                </div>
            </div>
            <div  style="margin-left :30%;" >
                    <button type="button" class="button" (click)="confirm()">Confirm</button>
            </div>
    </ng-template>
       
</div>

    